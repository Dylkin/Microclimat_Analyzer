# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ –≤ —Å–≤–æ–¥–Ω–æ–º –æ—Ç—á–µ—Ç–µ

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞**

–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∞–ª **4 –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ—Ç—á–µ—Ç–∞** –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞:

- 4 –æ—Ç—á–µ—Ç–∞ "–ò—Å–ø—ã—Ç–∞–Ω–∏–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –≤ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –æ–±—ä–µ–º–µ"
- 4 –æ—Ç—á–µ—Ç–∞ "–ò—Å–ø—ã—Ç–∞–Ω–∏–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è–º –≤ –ø—É—Å—Ç–æ–º –æ–±—ä–µ–º–µ"

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã**

### **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```typescript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö
const summaryReportData: TemplateReportData = {
  ...existingSummaryReport.reportData,  // –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
  title: `–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è–º - ${dataTypeLabel}`,
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
};

// –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ—Ç—á–µ—Ç–æ–≤
reconstructedSummaryBlob = await processor.processTemplate(
  reportStatus.templateFile,
  summaryReportData,
  chartRef.current
);
```

### **–ü—Ä–æ–±–ª–µ–º–∞:**
1. **–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö** - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ** - –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ—Ç—á–µ—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ
3. **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—á–µ—Ç–æ–≤ —É–¥–≤–∞–∏–≤–∞–µ—Ç—Å—è

## ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**

### **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ blob —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
const response = await fetch(existingSummaryReport.reportUrl);
existingSummaryBlob = await response.blob();

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É
updatedSummaryBlob = await processor.appendFullReportToExisting(
  existingSummaryBlob,  // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç
  docxBlob             // –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç
);
```

### **–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**

#### **1. –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ blob:**
```typescript
// –ü–æ–ª—É—á–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π blob —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
console.log('–ü–æ–ª—É—á–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...');
let existingSummaryBlob;
try {
  const response = await fetch(existingSummaryReport.reportUrl);
  if (!response.ok) {
    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞: ${response.status} ${response.statusText}`);
  }
  existingSummaryBlob = await response.blob();
  console.log('–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω, —Ä–∞–∑–º–µ—Ä:', existingSummaryBlob.size, '–±–∞–π—Ç');
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞:', error);
  throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: ${error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
}
```

#### **2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞:**
```typescript
// –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç –≤ –∫–æ–Ω–µ—Ü —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
console.log('–î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç –≤ –∫–æ–Ω–µ—Ü —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞...');
console.log('üîç DEBUG - –†–∞–∑–º–µ—Ä—ã blob:');
console.log('  - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç:', existingSummaryBlob.size, '–±–∞–π—Ç');
console.log('  - –ù–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—é:', docxBlob.size, '–±–∞–π—Ç');

updatedSummaryBlob = await processor.appendFullReportToExisting(
  existingSummaryBlob,  // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
  docxBlob             // –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç
);

console.log('–ù–æ–≤—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç');
console.log('üîç DEBUG - –†–∞–∑–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞:', updatedSummaryBlob.size, '–±–∞–π—Ç');
```

## üìä **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤**

### **‚ùå –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è):**
```
–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: [–û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3]
‚Üì
–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö: [–û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3] (–¥—É–±–ª–∏–∫–∞—Ç)
‚Üì
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ: [–û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3, –û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3, –ù–æ–≤—ã–π–û—Ç—á–µ—Ç]
‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç: 7 –æ—Ç—á–µ—Ç–æ–≤ (6 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ + 1 –Ω–æ–≤—ã–π)
```

### **‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É):**
```
–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: [–û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3]
‚Üì
–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ blob: [–û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3] (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
‚Üì
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ: [–û—Ç—á–µ—Ç1, –û—Ç—á–µ—Ç2, –û—Ç—á–µ—Ç3, –ù–æ–≤—ã–π–û—Ç—á–µ—Ç]
‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç: 4 –æ—Ç—á–µ—Ç–∞ (3 —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö + 1 –Ω–æ–≤—ã–π)
```

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—é
2. –ù–∞–π–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
   ```
   –ü–æ–ª—É—á–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...
   –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω, —Ä–∞–∑–º–µ—Ä: [—Ä–∞–∑–º–µ—Ä] –±–∞–π—Ç
   ```

### **–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ blob**
1. –í –ª–æ–≥–∞—Ö –Ω–∞–π–¥–∏—Ç–µ:
   ```
   üîç DEBUG - –†–∞–∑–º–µ—Ä—ã blob:
     - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: [—Ä–∞–∑–º–µ—Ä1] –±–∞–π—Ç
     - –ù–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—é: [—Ä–∞–∑–º–µ—Ä2] –±–∞–π—Ç
     - –†–∞–∑–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞: [—Ä–∞–∑–º–µ—Ä3] –±–∞–π—Ç
   ```

### **–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–∂–¥—ã–π –æ—Ç—á–µ—Ç –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
3. –ù–æ–≤—ã–π –æ—Ç—á–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω–µ—Ü

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∞–ª –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –æ—Ç—á–µ—Ç—ã
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç—á–µ—Ç–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–ª–æ—Å—å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É

**–¢–µ–ø–µ—Ä—å —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è!** ‚úÖ

## üìù **–ê–ª–≥–æ—Ä–∏—Ç–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
2. **–ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:**
   - –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ blob –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –≤ –∫–æ–Ω–µ—Ü
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
3. **–ï—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:**
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π blob, –∞ –Ω–µ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö!**




