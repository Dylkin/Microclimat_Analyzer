# Руководство по созданию шаблона DOCX с плейсхолдером {Table}

## Проблема
Плейсхолдер `{Table}` не отображает таблицу "Результаты анализа" в сформированном отчете.

## Причина
Плейсхолдер `{Table}` отсутствует в загруженном пользователем шаблоне DOCX.

## Решение

### 1. Создайте правильный шаблон DOCX

Создайте новый документ в Microsoft Word или аналогичном редакторе со следующим содержимым:

```
Отчет по испытаниям микроклимата

Наименование объекта квалификации: {Object}
Тип испытания: {NameTest}
Исполнитель: {Executor}
Дата испытания: {TestDate}

{chart}

{Table}

Выводы:
{Result}

Лимиты: {Limits}
```

### 2. Обязательные плейсхолдеры

#### Основные (рекомендуемые):
- `{chart}` - **ОБЯЗАТЕЛЬНЫЙ** - изображение графика
- `{Table}` - **ОБЯЗАТЕЛЬНЫЙ** - таблица результатов анализа
- `{Object}` - наименование объекта квалификации
- `{NameTest}` - тип испытания
- `{Executor}` - ФИО исполнителя
- `{TestDate}` - дата испытания

#### Дополнительные:
- `{Result}` - текст выводов
- `{Limits}` - установленные лимиты
- `{ReportNo}` - номер договора
- `{ReportDate}` - дата договора
- `{title}` - заголовок отчета
- `{date}` - дата создания отчета

### 3. Важные моменты

#### Правильное написание плейсхолдеров:
- ✅ `{Table}` - правильно
- ❌ `{results table}` - неправильно (пробел)
- ❌ `{ResultsTable}` - неправильно (заглавная буква)
- ❌ `{resultstable}` - неправильно (все строчные)

#### Размещение плейсхолдеров:
- Плейсхолдеры можно размещать в любом месте документа
- Они работают в основном тексте и в колонтитулах
- Плейсхолдер `{chart}` должен быть на отдельной строке
- Плейсхолдер `{Table}` должен быть на отдельной строке

### 4. Проверка шаблона

#### Перед загрузкой убедитесь, что:
1. Документ сохранен в формате DOCX
2. Все плейсхолдеры написаны правильно
3. Нет лишних пробелов или символов
4. Плейсхолдеры не разбиты на несколько строк

#### Проверка в консоли браузера:
После загрузки шаблона в консоли должно появиться:
```
Initial placeholders in document: ["{chart}", "{Table}", "{Object}", ...]
```

Если плейсхолдер `{Table}` отсутствует, появится предупреждение:
```
Шаблон не содержит плейсхолдер {Table}. Таблица результатов не будет вставлена.
```

### 5. Примеры шаблонов

#### Минимальный шаблон:
```
{chart}
{Table}
```

#### Полный шаблон:
```
ОТЧЕТ ПО ИСПЫТАНИЯМ МИКРОКЛИМАТА

Объект: {Object}
Тип испытания: {NameTest}
Исполнитель: {Executor}
Дата: {TestDate}

{chart}

РЕЗУЛЬТАТЫ АНАЛИЗА:
{Table}

ВЫВОДЫ:
{Result}

ЛИМИТЫ: {Limits}
```

### 6. Устранение проблем

#### Если таблица не отображается:
1. Проверьте правильность написания `{Table}`
2. Убедитесь, что есть данные для анализа
3. Проверьте консоль браузера на наличие ошибок

#### Если график не отображается:
1. Проверьте правильность написания `{chart}`
2. Убедитесь, что график загружен на странице

#### Если другие плейсхолдеры не работают:
1. Проверьте правильность написания
2. Убедитесь, что данные заполнены в форме

### 7. Техническая информация

#### Структура таблицы {Table}:
Таблица содержит следующие колонки:
- № зоны измерения
- Уровень измерения (м.)
- Наименование логгера
- Серийный № логгера
- Мин. t°C
- Макс. t°C
- Среднее t°C
- Соответствие лимитам

#### Форматирование:
- Таблица автоматически форматируется с границами
- Минимальные и максимальные значения выделяются цветом
- Соответствие лимитам отображается цветными индикаторами

## Заключение

Для корректной работы плейсхолдера `{Table}` необходимо:
1. Создать шаблон DOCX с правильным написанием плейсхолдера
2. Загрузить данные для анализа
3. Сформировать отчет

При соблюдении этих условий таблица результатов анализа будет корректно вставлена в документ.
