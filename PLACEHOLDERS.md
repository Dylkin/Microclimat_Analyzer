# Список плейсхолдеров для формирования приложения к отчету с результатами испытаний

## Обзор
Данный документ содержит полный список плейсхолдеров, поддерживаемых системой для формирования приложений к отчетам с результатами испытаний микроклимата.

## Основные плейсхолдеры

### Графики и таблицы
- **`{chart}`** - изображение графика температуры/влажности (PNG)
  - Обязательный плейсхолдер для корректной работы шаблона
  - Изображение вставляется с высоким разрешением
  - Автоматически поворачивается на 90° против часовой стрелки
  - Сохраняется в папку `word/media/`

- **`{Table}`** - таблица результатов анализа
  - Создает полную таблицу с результатами анализа
  - Включает все зоны измерения, уровни, серийные номера
  - Показывает минимальные и максимальные значения
  - Отображает соответствие лимитам

### Содержание отчета
- **`{Result}`** - текст выводов из поля "Выводы"
  - Заменяется на текст, введенный пользователем в поле "Выводы"
  - Если поле пустое, заменяется на пустую строку

- **`{Object}`** - наименование объекта квалификации
  - Наименование объекта квалификации, используемого на странице
  - Заполняется из настроек анализа

- **`{ConditioningSystem}`** - климатическая установка
  - Название климатической установки
  - Заполняется из настроек анализа

- **`{System}`** - климатическая установка (альтернативный)
  - Альтернативный плейсхолдер для климатической установки
  - Работает аналогично `{ConditioningSystem}`

- **`{NameTest}`** - тип испытания
  - Тип проводимого испытания (например, "Испытание на температуру")
  - Заполняется из настроек анализа

## Дополнительные плейсхолдеры

### Лимиты и параметры
- **`{Limits}`** - установленные лимиты с единицами измерения
  - Отображает установленные лимиты температуры/влажности
  - Включает единицы измерения (°C или %)
  - Форматируется в читаемом виде

### Исполнитель и даты
- **`{Executor}`** - ФИО исполнителя (текущий пользователь)
  - Автоматически заполняется данными текущего пользователя
  - Берется из системы аутентификации

- **`{TestDate}`** - дата испытания (текущая дата)
  - Дата проведения испытания
  - Форматируется в соответствии с настройками системы

- **`{ReportNo}`** - номер договора из настроек анализа
  - Номер договора или заказа
  - Заполняется из настроек анализа

- **`{ReportDate}`** - дата договора из настроек анализа
  - Дата заключения договора
  - Заполняется из настроек анализа

### Метаданные отчета
- **`{title}`** - заголовок отчета
  - Основной заголовок документа
  - Заполняется автоматически системой

- **`{date}`** - дата создания отчета
  - Дата создания отчета
  - Форматируется в соответствии с настройками системы

## Технические особенности

### Обработка плейсхолдеров
- Все плейсхолдеры обрабатываются в XML-структуре DOCX файла
- Специальные символы автоматически экранируются
- Разбитые плейсхолдеры автоматически объединяются

### Поддержка колонтитулов
- Все плейсхолдеры работают в верхних и нижних колонтитулах
- Поддерживаются файлы: `header1.xml`, `header2.xml`, `header3.xml`, `footer1.xml`, `footer2.xml`, `footer3.xml`

### Нормализация
- Система автоматически нормализует плейсхолдеры
- Объединяет разбитые XML-тегами плейсхолдеры
- Обеспечивает корректную замену во всех случаях

## Примеры использования

### Базовый шаблон
```
Отчет по испытаниям микроклимата
{title}

Наименование объекта квалификации: {Object}
Климатическая установка: {ConditioningSystem}
Тип испытания: {NameTest}
Исполнитель: {Executor}
Дата испытания: {TestDate}

{chart}

{Table}

Выводы:
{Result}

Лимиты: {Limits}
```

### Шаблон с колонтитулами
```
Верхний колонтитул: {title} - {date}
Основной текст: {Object} - {NameTest}
Нижний колонтитул: Исполнитель: {Executor} | Дата: {TestDate}
```

## Рекомендации

1. **Обязательные плейсхолдеры**: `{chart}` - обязателен для корректной работы
2. **Рекомендуемые**: `{Table}`, `{Result}`, `{Object}`, `{NameTest}`
3. **Дополнительные**: остальные плейсхолдеры по необходимости
4. **Тестирование**: всегда проверяйте шаблон перед использованием

## Поддержка
При возникновении проблем с плейсхолдерами:
1. Проверьте правильность написания (регистр важен)
2. Убедитесь, что плейсхолдеры не разбиты XML-тегами
3. Проверьте заполненность соответствующих полей в настройках анализа
