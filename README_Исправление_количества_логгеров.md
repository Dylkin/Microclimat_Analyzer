# Исправление некорректного отображения количества логгеров

## Проблема

На странице "Анализ данных" в блоке "Информация об объекте" поле "Логгеров" отображает некорректные данные - показывает количество зон измерения вместо реального количества логгеров, используемых на объекте квалификации.

## Причина

В компоненте `DataAnalysis.tsx` поле "Логгеров" использовало то же значение, что и "Точек измерения":
```tsx
// Неправильно - показывает количество зон измерения
<p className="text-gray-700">{selectedQualificationObject.measurementZones?.length || 0}</p>
```

Это приводило к тому, что:
- **"Точек измерения"** показывало количество зон измерения (правильно)
- **"Логгеров"** показывало то же значение (неправильно)

## Решение

### 1. Добавлен импорт сервиса логгеров
```tsx
import { loggerDataService } from '../utils/loggerDataService';
```

### 2. Добавлено состояние для хранения количества логгеров
```tsx
const [loggerCount, setLoggerCount] = useState<number>(0);
```

### 3. Создана функция загрузки количества логгеров
```tsx
const loadLoggerCount = async () => {
  // Загружаем данные логгеров из базы данных
  const loggerData = await loggerDataService.getLoggerDataSummary(
    fullProject.id,
    analysisData.qualificationObjectId
  );
  
  // Подсчитываем уникальные логгеры по имени файла
  const uniqueLoggers = new Set();
  loggerData.forEach(logger => {
    if (logger.fileName) {
      uniqueLoggers.add(logger.fileName);
    }
  });
  
  setLoggerCount(uniqueLoggers.size);
};
```

### 4. Обновлено отображение
```tsx
<div>
  <span className="font-medium text-gray-800">Логгеров:</span>
  <p className="text-gray-700">{loggerCount}</p> {/* Теперь показывает реальное количество */}
</div>
```

### 5. Добавлена загрузка при инициализации
```tsx
useEffect(() => {
  if (selectedQualificationObject && fullProject) {
    loadLoggerCount();
  }
}, [selectedQualificationObject, fullProject]);
```

## Результат

После применения исправлений:

1. ✅ **"Точек измерения"** показывает количество зон измерения объекта квалификации
2. ✅ **"Логгеров"** показывает реальное количество загруженных и обработанных логгеров
3. ✅ **Данные загружаются из базы данных** в реальном времени
4. ✅ **Добавлено логирование** для диагностики

## Логика подсчета

Количество логгеров подсчитывается следующим образом:

1. **Загружаются данные** из таблицы `logger_data_summary` для конкретного объекта квалификации
2. **Подсчитываются уникальные логгеры** по имени файла (каждый файл = один логгер)
3. **Исключаются дубликаты** - если один логгер загружен несколько раз, он считается как один

## Диагностика

В консоли браузера вы увидите логи:

```
DataAnalysis: Загружено логгеров: 3 из 5 записей
```

Это означает, что найдено 3 уникальных логгера из 5 записей в базе данных.

## Отладочная информация

В блоке "Отладочная информация" теперь отображается:
- `loggerCount` - количество логгеров
- `measurementZones` - количество зон измерения

Это помогает понять разницу между двумя значениями.

## Тестирование

Для проверки исправления:

1. Откройте страницу "Анализ данных" для объекта квалификации
2. Убедитесь, что:
   - **"Точек измерения"** показывает количество зон измерения
   - **"Логгеров"** показывает количество загруженных файлов логгеров
   - Значения могут отличаться (это нормально)

## Пример

**До исправления:**
- Точек измерения: 5
- Логгеров: 5 (неправильно - показывало то же значение)

**После исправления:**
- Точек измерения: 5 (зоны измерения объекта)
- Логгеров: 3 (реальное количество загруженных логгеров)



















