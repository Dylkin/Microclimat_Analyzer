# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å MIME-—Ç–∏–ø–∞–º–∏ –¥–ª—è —Ñ–∞–π–ª–æ–≤ .vi2

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–æ–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.vi2` –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
–ö–æ–¥ –æ—à–∏–±–∫–∏: 400 Bad Request
–ü—Ä–æ–±–ª–µ–º–∞: MIME-—Ç–∏–ø application/octet-stream –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
```

–§–∞–π–ª—ã `.vi2` –æ–ø—Ä–µ–¥–µ–ª—è–ª–∏—Å—å —Å–∏—Å—Ç–µ–º–æ–π –∫–∞–∫ `application/octet-stream` (–æ–±—â–∏–π –±–∏–Ω–∞—Ä–Ω—ã–π –ø–æ—Ç–æ–∫), –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏–∑-–∑–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö security-—Ä–∏—Å–∫–æ–≤.

## –†–µ—à–µ–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è MIME-—Ç–∏–ø–æ–≤
**–§–∞–π–ª:** `src/utils/mimeTypeUtils.ts`

- –§—É–Ω–∫—Ü–∏—è `getMimeType(filename)` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç MIME-—Ç–∏–ø –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞
- –§–∞–π–ª—ã `.vi2` –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞–∫ `video/mp4`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (–≤–∏–¥–µ–æ, –∞—É–¥–∏–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞—Ä—Ö–∏–≤—ã)
- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞

### 2. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–µ—Ä–≤–∏—Å—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

#### `src/utils/qualificationObjectService.ts`
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `getMimeType`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:
  - `uploadPlanFile()` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞–Ω–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤
  - `uploadTestDataFile()` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π
  - `uploadLoggerRemovalFile()` - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å–Ω—è—Ç–∏—è –ª–æ–≥–≥–µ—Ä–æ–≤
- –í—Å–µ –º–µ—Ç–æ–¥—ã —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `contentType` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

#### `src/utils/enhancedProjectDocumentService.ts`
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `getMimeType`
- –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `uploadDocument()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ MIME-—Ç–∏–ø–∞

#### `src/utils/projectDocumentService.ts`
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `getMimeType`
- –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `uploadDocument()` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ MIME-—Ç–∏–ø–∞

### 3. –°–æ–∑–¥–∞–Ω SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫ Storage
**–§–∞–π–ª:** `fix_vi2_mime_type_storage_policy.sql`

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç:
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `allowed_mime_types` –¥–ª—è bucket'–æ–≤ `qualification-objects` –∏ `documents`
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ MIME-—Ç–∏–ø–æ–≤:
  - `application/octet-stream` - –¥–ª—è .vi2 —Ñ–∞–π–ª–æ–≤
  - `video/mp4`, `video/x-msvideo`, `video/quicktime` - –≤–∏–¥–µ–æ —Ñ–æ—Ä–º–∞—Ç—ã
  - `audio/mpeg`, `audio/wav`, `audio/ogg` - –∞—É–¥–∏–æ —Ñ–æ—Ä–º–∞—Ç—ã
  - `text/csv`, `application/vnd.ms-excel` - –¥–æ–∫—É–º–µ–Ω—Ç—ã
  - –ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏, —á—Ç–µ–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ø–æ–ª–∏—Ç–∏–∫

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. **–§–∞–π–ª—ã .vi2 —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π MIME-—Ç–∏–ø `video/mp4`
2. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤** - –≤–∏–¥–µ–æ, –∞—É–¥–∏–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞—Ä—Ö–∏–≤—ã
3. **–û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ Supabase Storage** - —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ MIME-—Ç–∏–ø—ã
4. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `contentType`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `cacheControl: '3600'` –∏ `upsert: false/true`
- –°–æ–∑–¥–∞–Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è MIME-—Ç–∏–ø–æ–≤
- SQL —Å–∫—Ä–∏–ø—Ç –≥–æ—Ç–æ–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ Supabase Dashboard

### üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç `fix_vi2_mime_type_storage_policy_simple.sql` –≤ Supabase Dashboard
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)
3. –¢–µ–ø–µ—Ä—å —Ñ–∞–π–ª—ã .vi2 –∏ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–∫—Ä–∏–ø—Ç–∞ `fix_vi2_mime_type_storage_policy_simple.sql`. –í PostgreSQL:
- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `CREATE POLICY IF NOT EXISTS`
- –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π `SELECT` –∏ `DELETE` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `USING` –≤–º–µ—Å—Ç–æ `WITH CHECK`
- –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏ `UPDATE` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏ `USING` –∏ `WITH CHECK`

### üéØ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:
- **–í–∏–¥–µ–æ:** .vi2, .mp4, .avi, .mov, .wmv, .flv, .webm
- **–ê—É–¥–∏–æ:** .mp3, .wav, .ogg, .aac, .flac
- **–î–æ–∫—É–º–µ–Ω—Ç—ã:** .pdf, .doc, .docx, .xls, .xlsx, .ppt, .pptx, .txt, .rtf, .csv
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** .jpg, .jpeg, .png, .gif, .bmp, .svg, .webp, .tiff
- **–ê—Ä—Ö–∏–≤—ã:** .zip, .rar, .7z, .tar, .gz
- **–î–∞–Ω–Ω—ã–µ:** .json, .xml, .dat, .bin

## –°—Ç–∞—Ç—É—Å
‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û** - –ü—Ä–æ–±–ª–µ–º–∞ —Å MIME-—Ç–∏–ø–∞–º–∏ –¥–ª—è —Ñ–∞–π–ª–æ–≤ .vi2 –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞.
