# Тестирование плейсхолдера {Table}

## Проблема
В сформированном файле отчета на основании загруженного пользователем шаблона в формате DOCX не отображаются данные плейсхолдера `{Table}`.

## Внесенные исправления

### 1. Добавлено подробное логирование
- **В `processTablePlaceholder()`**: логирование процесса обработки плейсхолдера
- **В `createResultsTableXml()`**: логирование создания XML таблицы
- **В `TimeSeriesAnalyzer.tsx`**: логирование данных, передаваемых в шаблон

### 2. Отладочная информация
Теперь в консоли браузера будет отображаться:
- Наличие плейсхолдера `{Table}` в документе
- Количество результатов анализа
- Длина сгенерированного XML таблицы
- Предварительный просмотр XML таблицы

## Как протестировать

### 1. Создайте тестовый шаблон DOCX
Создайте простой DOCX файл со следующим содержимым:

```
Отчет по испытаниям микроклимата

{Object}
{NameTest}
{Executor}
{TestDate}

{Table}

Выводы:
{Result}
```

### 2. Загрузите данные
- Загрузите файлы с данными логгеров
- Убедитесь, что есть результаты анализа в таблице "Результаты анализа"

### 3. Сформируйте отчет
- Загрузите тестовый шаблон
- Нажмите "Сформировать отчет"
- Проверьте консоль браузера на наличие отладочной информации

### 4. Проверьте результат
- Скачайте сформированный отчет
- Убедитесь, что плейсхолдер `{Table}` заменен на таблицу с данными

## Ожидаемое поведение

### В консоли браузера должно появиться:
```
TemplateData for {Table}:
- analysisResults count: X
- analysisResults data: [...]
- dataType: temperature

Processing {Table} placeholder...
Document contains {Table}: true
Analysis results count: X
Creating results table XML...
Results count: X
DataType: temperature
Results data: [...]
Non-external results count: X
Global min temp: XX.X
Global max temp: XX.X
Generated table XML length: XXXX
Table XML preview: <w:tbl>...
Generated full table XML length: XXXX
Table XML ends with: ...</w:tbl>
{Table} placeholder replaced successfully
```

### В сформированном документе:
- Плейсхолдер `{Table}` должен быть заменен на таблицу с данными
- Таблица должна содержать все строки из "Результаты анализа"
- Таблица должна иметь правильное форматирование

## Возможные проблемы

### 1. Плейсхолдер не найден
Если в консоли: `Document contains {Table}: false`
- Проверьте, что в шаблоне точно написан `{Table}`
- Убедитесь, что нет лишних пробелов или символов

### 2. Нет данных анализа
Если в консоли: `Analysis results count: 0`
- Убедитесь, что загружены файлы с данными
- Проверьте, что данные корректно обработаны
- Убедитесь, что в таблице "Результаты анализа" есть строки

### 3. Ошибка генерации XML
Если в консоли есть ошибки при создании XML:
- Проверьте структуру данных `analysisResults`
- Убедитесь, что все необходимые поля присутствуют

## Следующие шаги

После тестирования:
1. Если проблема решена - удалить отладочное логирование
2. Если проблема не решена - проанализировать логи и найти причину
3. При необходимости - добавить дополнительную отладку
