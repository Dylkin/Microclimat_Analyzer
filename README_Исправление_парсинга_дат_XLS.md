# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç –≤ XLS —Ñ–∞–π–ª–∞—Ö

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞**

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ XLS —Ñ–∞–π–ª–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ª–æ–≥–≥–µ—Ä–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç:

```
XLSParser: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã: Error: –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: 13.06.2025 0:00:00
```

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `parseDateTime` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∞ —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–º–∏ —á–∞—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `0:00:00` –≤–º–µ—Å—Ç–æ `00:00:00`).

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã**

### **–§–æ—Ä–º–∞—Ç –¥–∞—Ç –≤ —Ñ–∞–π–ª–µ:**
- **–î–∞—Ç–∞:** `13.06.2025` (DD.MM.YYYY)
- **–í—Ä–µ–º—è:** `0:00:00`, `0:01:00`, `0:02:00` –∏ —Ç.–¥. (H:MM:SS)
- **–ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** `13.06.2025 0:00:00`

### **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ:**
–§—É–Ω–∫—Ü–∏—è `parseDateTime` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `new Date()` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–º–∏ —á–∞—Å–∞–º–∏.

## üîß **–†–µ—à–µ–Ω–∏–µ**

### **1. –î–æ–±–∞–≤–ª–µ–Ω —Ç–æ—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏**

**–ù–æ–≤—ã–π –∫–æ–¥ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `parseDateTime`:**
```typescript
// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –ø–∞—Ä—Å–∏–Ω–≥ —Å –ø–æ–º–æ—â—å—é —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
const dateTimeRegex = /^(\d{1,2})\.(\d{1,2})\.(\d{4})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})$/;
const dateOnlyRegex = /^(\d{1,2})\.(\d{1,2})\.(\d{4})$/;

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç DD.MM.YYYY H:MM:SS –∏–ª–∏ DD.MM.YYYY HH:MM:SS
const dateTimeMatch = dateStr.match(dateTimeRegex);
if (dateTimeMatch) {
  const [, day, month, year, hour, minute, second] = dateTimeMatch;
  const date = new Date(
    parseInt(year),
    parseInt(month) - 1, // –º–µ—Å—è—Ü—ã –≤ JS –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 0
    parseInt(day),
    parseInt(hour),
    parseInt(minute),
    parseInt(second)
  );
  
  if (!isNaN(date.getTime())) {
    return date;
  }
}
```

### **2. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**

**–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ `dateTimeRegex`:**
- `(\d{1,2})` - –¥–µ–Ω—å (1-2 —Ü–∏—Ñ—Ä—ã)
- `\.` - —Ç–æ—á–∫–∞
- `(\d{1,2})` - –º–µ—Å—è—Ü (1-2 —Ü–∏—Ñ—Ä—ã)  
- `\.` - —Ç–æ—á–∫–∞
- `(\d{4})` - –≥–æ–¥ (4 —Ü–∏—Ñ—Ä—ã)
- `\s+` - –æ–¥–∏–Ω –∏–ª–∏ –±–æ–ª–µ–µ –ø—Ä–æ–±–µ–ª–æ–≤
- `(\d{1,2})` - —á–∞—Å—ã (1-2 —Ü–∏—Ñ—Ä—ã) ‚Üê **–ö–ª—é—á–µ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
- `:` - –¥–≤–æ–µ—Ç–æ—á–∏–µ
- `(\d{1,2})` - –º–∏–Ω—É—Ç—ã (1-2 —Ü–∏—Ñ—Ä—ã)
- `:` - –¥–≤–æ–µ—Ç–æ—á–∏–µ
- `(\d{1,2})` - —Å–µ–∫—É–Ω–¥—ã (1-2 —Ü–∏—Ñ—Ä—ã)

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏:**
- ‚úÖ `0:00:00` (–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã)
- ‚úÖ `00:00:00` (–¥–≤—É–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã)
- ‚úÖ `1:30:45` (–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã)
- ‚úÖ `23:59:59` (–¥–≤—É–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã)

### **3. –õ–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞**

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç Date
   ‚Üì
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Excel serial number
   ‚Üì
3. –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫–∏ —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏
   ‚Üì
4. Fallback –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
   ‚Üì
5. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π new Date()
```

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
XLSParser: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã: Error: –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: 13.06.2025 0:00:00
XLSParser: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–≥–µ—Ä–∞: Error: –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã: –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: 13.06.2025 0:00:00
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
XLSParser: –ù–∞–π–¥–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞: {
  headerRow: 11,
  dataStartRow: 12,
  idColumn: 0,
  timestampColumn: 1,
  temperatureColumn: 2,
  deviceInfo: {...}
}
XLSParser: –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞ —Å —Å—Ç—Ä–æ–∫–∏ 13
XLSParser: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω: {
  recordCount: 16000,
  startDate: "2025-06-13T00:00:00.000Z",
  endDate: "2025-06-15T11:39:00.000Z",
  deviceInfo: {...}
}
```

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏:**

**1. –û–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã:**
- ‚úÖ `13.06.2025 0:00:00` ‚Üí `2025-06-13T00:00:00.000Z`
- ‚úÖ `13.06.2025 1:30:45` ‚Üí `2025-06-13T01:30:45.000Z`
- ‚úÖ `13.06.2025 9:15:30` ‚Üí `2025-06-13T09:15:30.000Z`

**2. –î–≤—É–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã:**
- ‚úÖ `13.06.2025 00:00:00` ‚Üí `2025-06-13T00:00:00.000Z`
- ‚úÖ `13.06.2025 23:59:59` ‚Üí `2025-06-13T23:59:59.000Z`

**3. –¢–æ–ª—å–∫–æ –¥–∞—Ç–∞:**
- ‚úÖ `13.06.2025` ‚Üí `2025-06-13T00:00:00.000Z`

**4. –î—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã:**
- ‚úÖ `2025-06-13 0:00:00` ‚Üí `2025-06-13T00:00:00.000Z`
- ‚úÖ `2025-06-13` ‚Üí `2025-06-13T00:00:00.000Z`

## üîÑ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**

### **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
- ‚úÖ Excel serial numbers
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç
- ‚úÖ –†–∞–∑–¥–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –†–∞–∑–ª–∏—á–Ω—ã–µ –ª–æ–∫–∞–ª–∏

### **–£–ª—É—á—à–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞:**
- ‚úÖ –†—É—Å—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç (DD.MM.YYYY)
- ‚úÖ –û–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ —á–∞—Å—ã (H:MM:SS)
- ‚úÖ –¢–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–∞—Ä—Å–∏–Ω–≥–∞

## üìÅ **–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**

- `src/utils/xlsParser.ts` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `parseDateTime`

## üéØ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç –≤ XLS —Ñ–∞–π–ª–∞—Ö:

- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏—Å—å –¥–∞—Ç—ã —Å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–º–∏ —á–∞—Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `0:00:00`)
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω —Ç–æ—á–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –≤—Ä–µ–º–µ–Ω–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞

**–¢–µ–ø–µ—Ä—å XLS –ø–∞—Ä—Å–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞ —Å –ª—é–±—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏!** üéâ



















