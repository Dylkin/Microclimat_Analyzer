# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ {TestDate} - —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞**

–ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä `{TestDate}` –¥–æ–ª–∂–µ–Ω –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –¥–∞—Ç—É –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞—Å—å –ø–æ–ª–Ω–∞—è –¥–∞—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º.

## üîç **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–í TimeSeriesAnalyzer.tsx:**
```typescript
const now = new Date();
const dateStr = now.toLocaleDateString('ru-RU'); // –§–æ—Ä–º–∞—Ç: "–¥–¥.–º–º.–≥–≥–≥–≥"
const timeStr = now.toLocaleTimeString('ru-RU');

const templateData: TemplateReportData = {
  // ...
  testDate: dateStr, // –¢–æ–ª—å–∫–æ –¥–∞—Ç–∞
  // ...
};
```

### **–í docxTemplateProcessor.ts:**
```typescript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ {TestDate} –¥–ª—è –¥–∞—Ç—ã –∏—Å–ø—ã—Ç–∞–Ω–∏—è
if (data.testDate) {
  console.log('Replacing {TestDate} with:', data.testDate);
  result = result.replace(/{TestDate}/g, this.escapeXml(data.testDate));
}
```

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

### **1. –£—Å–∏–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ docxTemplateProcessor.ts:**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏, —á—Ç–æ –≤ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä `{TestDate}` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞:

```typescript
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ {TestDate} –¥–ª—è –¥–∞—Ç—ã –∏—Å–ø—ã—Ç–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏)
if (data.testDate) {
  // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
  let dateOnly = data.testDate;
  
  // –ï—Å–ª–∏ testDate —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Ä–µ–º—è, –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–∞—Ç—É
  if (dateOnly.includes(' ')) {
    dateOnly = dateOnly.split(' ')[0];
  }
  
  // –ï—Å–ª–∏ —ç—Ç–æ ISO —Å—Ç—Ä–æ–∫–∞, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –¥–∞—Ç—É
  if (dateOnly.includes('T') || dateOnly.includes('-')) {
    try {
      const date = new Date(dateOnly);
      if (!isNaN(date.getTime())) {
        dateOnly = date.toLocaleDateString('ru-RU');
      }
    } catch (error) {
      console.warn('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã:', error);
    }
  }
  
  console.log('Replacing {TestDate} with date only:', dateOnly);
  result = result.replace(/{TestDate}/g, this.escapeXml(dateOnly));
}
```

### **2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–ª–∞–¥–∫–∞ –≤ TimeSeriesAnalyzer.tsx:**

```typescript
// –û—Ç–ª–∞–¥–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã
console.log('Generated dateStr for TestDate:', dateStr);
console.log('Generated timeStr:', timeStr);
```

## üìä **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç—ã**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–¥–¥.–º–º.–≥–≥–≥–≥)**
- **–í—Ö–æ–¥**: `"19.10.2025"`
- **–í—ã—Ö–æ–¥**: `"19.10.2025"` ‚úÖ

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–∞—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º (–¥–¥.–º–º.–≥–≥–≥–≥ —á—á:–º–º:—Å—Å)**
- **–í—Ö–æ–¥**: `"19.10.2025 14:30:25"`
- **–í—ã—Ö–æ–¥**: `"19.10.2025"` ‚úÖ (–≤—Ä–µ–º—è —É–¥–∞–ª—è–µ—Ç—Å—è)

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: ISO —Ñ–æ—Ä–º–∞—Ç (–≥–≥–≥–≥-–º–º-–¥–¥)**
- **–í—Ö–æ–¥**: `"2025-10-19"`
- **–í—ã—Ö–æ–¥**: `"19.10.2025"` ‚úÖ (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)

### **–°—Ü–µ–Ω–∞—Ä–∏–π 4: ISO —Å –≤—Ä–µ–º–µ–Ω–µ–º (–≥–≥–≥–≥-–º–º-–¥–¥T—á—á:–º–º:—Å—Å)**
- **–í—Ö–æ–¥**: `"2025-10-19T14:30:25"`
- **–í—ã—Ö–æ–¥**: `"19.10.2025"` ‚úÖ (–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏)

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞—Ç—ã**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –æ—Ç—á–µ—Ç
3. –ù–∞–π–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
   ```
   Generated dateStr for TestDate: 19.10.2025
   Generated timeStr: 14:30:25
   ```

### **–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞**
1. –í –ª–æ–≥–∞—Ö –Ω–∞–π–¥–∏—Ç–µ:
   ```
   Replacing {TestDate} with date only: 19.10.2025
   ```

### **–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π DOCX —Ñ–∞–π–ª
2. –ù–∞–π–¥–∏—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä `{TestDate}`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–¥–¥.–º–º.–≥–≥–≥–≥"

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –í–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è–ª–∞—Å—å –¥–∞—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º: `"19.10.2025 14:30:25"`

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–∞—Ç–∞: `"19.10.2025"`

## üìã **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤—Ö–æ–¥–∞**

1. **–†—É—Å—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç**: `"19.10.2025"` ‚Üí `"19.10.2025"`
2. **–†—É—Å—Å–∫–∏–π —Å –≤—Ä–µ–º–µ–Ω–µ–º**: `"19.10.2025 14:30:25"` ‚Üí `"19.10.2025"`
3. **ISO –¥–∞—Ç–∞**: `"2025-10-19"` ‚Üí `"19.10.2025"`
4. **ISO —Å –≤—Ä–µ–º–µ–Ω–µ–º**: `"2025-10-19T14:30:25"` ‚Üí `"19.10.2025"`

**–¢–µ–ø–µ—Ä—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä {TestDate} –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –¥–∞—Ç—É –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏!** ‚úÖ




