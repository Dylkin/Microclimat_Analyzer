# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞**

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è–º –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:

```
Failed to load resource: net::ERR_FILE_NOT_FOUND
–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: TypeError: Failed to fetch
```

### **–ü—Ä–∏—á–∏–Ω–∞:**
- –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å blob URL –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: `fetch(existingSummaryReport.reportUrl)`
- Blob URL —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- `net::ERR_FILE_NOT_FOUND` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å blob URL

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã**

### **–ü—Ä–µ–¥—ã–¥—É—â–∞—è –ª–æ–≥–∏–∫–∞ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è):**
```typescript
// –ü–æ–ª—É—á–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π blob —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
const existingSummaryBlob = await fetch(existingSummaryReport.reportUrl).then(response => response.blob());
```

### **–ü—Ä–æ–±–ª–µ–º–∞:**
- Blob URL —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ**

### **1. –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –∏–∑ –¥–∞–Ω–Ω—ã—Ö:**

–í–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ blob URL, —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –µ–≥–æ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```typescript
// –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –µ–≥–æ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
console.log('–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –¥–∞–Ω–Ω—ã—Ö:', existingSummaryReport.reportData);

// –î–æ–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–º–∏ –ø–æ–ª—è–º–∏
const summaryReportData: TemplateReportData = {
  ...existingSummaryReport.reportData,
  title: `–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è–º - ${dataTypeLabel}`,
  date: `${dateStr} ${timeStr}`,
  dataType: dataType as 'temperature' | 'humidity'
};

const reconstructedSummaryBlob = await processor.processTemplate(
  reportStatus.templateFile,
  summaryReportData,
  chartRef.current
);
```

### **2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**

```typescript
try {
  reconstructedSummaryBlob = await processor.processTemplate(
    reportStatus.templateFile,
    summaryReportData,
    chartRef.current
  );
  console.log('–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω');
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞:', error);
  throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: ${error.message}`);
}
```

### **3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏:**

```typescript
try {
  updatedSummaryBlob = await processor.appendFullReportToExisting(
    reconstructedSummaryBlob,
    docxBlob
  );
  console.log('–ù–æ–≤—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç');
} catch (error) {
  console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞ –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç:', error);
  throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: ${error.message}`);
}
```

## üìä **–ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã**

### **–®–∞–≥ 1: –ü–æ–∏—Å–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
```typescript
const existingSummaryReport = await reportService.findExistingReport(
  projectId, 
  qualificationObjectId, 
  summaryReportName
);
```

### **–®–∞–≥ 2: –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
- –ò–∑–≤–ª–µ–∫–∞–µ–º `reportData` –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –î–æ–ø–æ–ª–Ω—è–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–º–∏ –ø–æ–ª—è–º–∏ (`title`, `date`, `dataType`)
- –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º blob —Å –ø–æ–º–æ—â—å—é `processor.processTemplate()`

### **–®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `processor.appendFullReportToExisting()`
- –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç –≤ –∫–æ–Ω–µ—Ü —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞

### **–®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π blob URL
- –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
1. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—é
2. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç**
1. –°–æ–∑–¥–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—é
2. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
   - –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ—Ç—Å—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö
   - –ù–æ–≤—ã–π –æ—Ç—á–µ—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü
   - –ù–µ—Ç –æ—à–∏–±–∫–∏ `net::ERR_FILE_NOT_FOUND`

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
   ```
   –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –¥–∞–Ω–Ω—ã—Ö: {...}
   –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω
   –ù–æ–≤—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç
   ```

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞**

1. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç blob URL, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏
2. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è `TemplateReportData`

## üìã **–õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏**

### **–£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
```
–î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è–º...
–†–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–µ–º —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∏–∑ –¥–∞–Ω–Ω—ã—Ö: {dataType: "temperature", analysisResults: [...], ...}
–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω
–ù–æ–≤—ã–π –æ—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç
```

### **–û—à–∏–±–∫–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:**
```
–û—à–∏–±–∫–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞: [–¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏]
–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: [—Å–æ–æ–±—â–µ–Ω–∏–µ]
```

### **–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**
```
–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç—á–µ—Ç–∞ –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: [–¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏]
–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: [—Å–æ–æ–±—â–µ–Ω–∏–µ]
```

**–¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫ blob URL!** ‚úÖ




